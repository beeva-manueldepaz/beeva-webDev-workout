<!DOCTYPE html>
<html>
<head>
	<title>Exercise 1</title>
	<script src="js/modernizr-custom.js"></script>
	<style>
		/*A basic stylesheet*/
		body{
			background-color: #eee;
			font-family: "Times New Roman", Times, serif;
		}
		li{
			list-style: none;
			border-bottom: 1px solid #ccc;
		}
		section{
			width: 1000px;
			height: auto;
			margin: 10px auto;
			clear: both;
		}
		footer p
		{
			margin: 0px auto;
			text-align: center;
		}
		#song{
			margin: 5px 5px;
		}
		.check{
			float: right;
			clear: both;
			display: inline-block;
		}
		.column{
			width: 350px;
			float: left;
		}	
		#section-2{
			border-top: 1px solid #000;
			border-bottom: 1px solid #000;
		}
		#section-4{
			margin: 0px auto;
			border-top: 1px solid #000;
		}
	</style>
</head>
<body>
	<header>
		<h1>First Front-End Exercise</h1>
	</header>

	<section id="section-1">
		<div class="column">
			<h2>Check through Modernizr</h2>
			<ul id="column1"></ul>
		</div>
		<div class="column">
			<h2>Check through HTML5</h2>
			<ul id="column2"></ul>
		</div>
	</section>
	<section id="section-2">
		<h2>Test with audio file: Armin van Buuren & Jean-Michael Jarre - Stardust</h2>
		<audio id="song" controls>
			 <source src="files/Stardust.mp3">
		</audio>
	</section>
	<section id="section-3">
		<h1>Testing HTML5 Geolocation API</h1>
		<button onclick="get_location()">Get position</button>
		<button onclick="print_map()">Print Map</button>
		<p id="position"></p>
	</section>
	<section id="section-4">
		<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
		<article></article>
	</section>
	<footer>
		<p>This was only an example of using some HTML5 APIs</p>
	</footer>
	<script>

		/////////////////////////////////////////////
		///////////// DOUBLE LIST SECTION////////////
		/////////////////////////////////////////////

		//Some HTML5 APIs to check
		var mock_input = ['canvas', 'audio', 'fullscreen', 'batteryapi', 'video', 'proximity', 'geolocation', 'cookies'];
		id1 = "column1";
		id2 = "column2";

		check_modernizr(mock_input, id1);
		check_html5(mock_input, id2);

		//This function checks if current browser supports any of the Modarnizr APIs contained in V and prints the result
		function check_modernizr(v, id)
		{
			var output = "";
			for(i = 0; i < v.length; i++)
			{
				if(Modernizr[v[i]])
				{
					output += '<li id="element'+i+'">'+v[i]+' <input class="check" type="checkbox" checked="checked" disabled="true"></li>';
				}
				else
				{
					output += '<li id="element'+i+'">'+v[i]+' <input class="check" type="checkbox" disabled="true"></li>';
				}
			}
			document.getElementById(id).innerHTML = output;
		}

		//This function checks if current browser supports any of the HTML5 APIs contained in V and prints the result
		function check_html5(v, id)
		{
			var output = "";
			for(i = 0; i < v.length; i++)
			{
				if(html5_element_supported(v[i]))
				{
					output += '<li id="element'+i+'">'+v[i]+' <input class="check" type="checkbox" checked="checked" disabled="true"></li>';	
				}
				else
				{
					output += '<li id="element'+i+'">'+v[i]+' <input class="check" type="checkbox" disabled="true"></li>';
				}
			}
			document.getElementById(id).innerHTML = output;
		}

		//Detects if tag is compatible with this browser using native JS only
		function html5_element_supported(tag)
		{
			if(navigator[tag])
			{	
				return true;
			}
			else
			{
				var element = document.createElement(tag);
		    	if(Object.prototype.toString.call(element) !== '[object HTMLUnknownElement]')
		    	{
		    		return true;
		    	}
		    	else
		    	{
		    		if(tag == 'fullscreen')
		    		{
		    			return(document.fullscreenEnabled || 
								document.webkitFullscreenEnabled || 
								document.mozFullScreenEnabled ||
								document.msFullscreenEnabled
							);
		    		}
		    		else if(tag == 'batteryapi')
		    		{
		    			return(navigator.battery || 
		    					navigator.webkitBattery || 
		    					navigator.mozBattery || 
		    					navigator.msBattery
		    				);
		    		}
		    		else if(tag == 'cookies')
		    		{
		    			return navigator.cookieEnabled;
		    		}
		    		else
		    			return false;
		    	}
			}
		}

		/////////////////////////////////////////////
		////////// MAP AND POSITION SECTION//////////
		/////////////////////////////////////////////

		var elm = document.getElementById("position");

		//Obtains our location
		function get_location()
		{
		    if(html5_element_supported('geolocation'))
		    {	
		        navigator.geolocation.getCurrentPosition(show_position);
		    }
		    else
		    { 
		        elm.innerHTML = "Geolocation is not supported by this browser.";
		    }
		}

		//Prints our position on the element selected
		function show_position(position)
		{
		    elm.innerHTML = "Latitude: " + position.coords.latitude + "<br>Longitude: " + position.coords.longitude;
		}
		function print_map()
		{
			navigator.geolocation.getCurrentPosition(success);
		}

		//Print Google Map with our location, obtained by Geolocation HTML5 API
		function success(position)
		{
			var mapcanvas = document.createElement('div');
			mapcanvas.id = 'mapcontainer';
			mapcanvas.style.height = '500px';
			mapcanvas.style.width = '800px';
			mapcanvas.style.margin = '0px auto';

			document.querySelector('article').appendChild(mapcanvas);

			var coords = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);

			var options = {
				zoom: 15,
				center: coords,
				mapTypeControl: false,
				navigationControlOptions: {
				style: google.maps.NavigationControlStyle.SMALL
			},
				mapTypeId: google.maps.MapTypeId.ROADMAP
			};
			var map = new google.maps.Map(document.getElementById("mapcontainer"), options);

			var marker = new google.maps.Marker
			({
				position: coords,
				map: map,
				title:"You are here!"
			});
		}
	</script>
</body>
</html>